<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Экзаменационные вопросы по модулю ОПП</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header>
        <h1>билеты</h1>
        <nav>
            <ul>
                <li><a href="#ticket1">Билет 1</a></li>
                <li><a href="#ticket2">Билет 2</a></li>
		<li><a href="#ticket3">Билет 3</a></li>
		<li><a href="#ticket4">Билет 4</a></li>
		<li><a href="#ticket5">Билет 5</a></li>
		<li><a href="#ticket6">Билет 6</a></li>
		<li><a href="#ticket7">Билет 7</a></li>
		<li><a href="#ticket8">Билет 8</a></li>
		<li><a href="#ticket9">Билет 9</a></li>
		<li><a href="#ticket10">Билет 10</a></li>
		<li><a href="#ticket11">Билет 11</a></li>
		<li><a href="#ticket12">Билет 12</a></li>
		<li><a href="#ticket13">Билет 13</a></li>
		<li><a href="#ticket14">Билет 14</a></li>
		<li><a href="#ticket15">Билет 15</a></li>
		<li><a href="#ticket16">Билет 16</a></li>
		<li><a href="#ticket17">Билет 17</a></li>
		<li><a href="#ticket18">Билет 18</a></li>
            </ul>
        </nav>
    </header>
    <main>
        <section id="ticket1">
            <h2>Билет 1</h2>
            <h3>Агрегированные функции для анализа данных. GROUP BY в А-функциях. Приведите примеры.</h3>
            <p>Агрегатная функция выполняет вычисление над набором строк и возвращает одно значение. Производится расчет данных верхнего уровня на основе данных нижнего уровня. Агрегированные функции в базах данных используются для вычисления сумм, средних значений, минимумов, максимумов и других агрегированных результатов по группам данных. Оператор GROUP BY используется в SQL для группировки строк на основе значений столбца или столбцов и применения агрегированных функций к каждой группе. 
		    Агрегированные функции: sum, avg, min, max, count, std or stdev, var – вычисляет дисперсию
		    Оператор GROUP BY позволяет проводить группировку данных и применять агрегированные функции к каждой группе отдельно, что полезно для анализа данных по различным категориям или группам в SQL.
</p>
            <pre><code>
Сумма покупок каждого клиента:
		    
select customer_id, round(sum(sales_amount))
from sales
group by customer_id;
            </code></pre>
            <pre><code>
Максимальный и минимальный размеры заказа каждого клиента

select customer_id, min(sales_amount) as минимальный_заказ, max(sales_amount) as максимальный_заказ
from sales
group by customer_id;
            </code></pre>
            <pre><code>
Количество покупок каждого клиента

select customer_id, count(sales_transaction_date)
from sales
group by customer_id;
            </code></pre>
            <h3>Создайте в CMS WordPress пользовательское меню из трех пунктов, к каждому из которых привязана отдельная страница. Разместите на страницах изображения, таблицы, маркированные списки и ссылки.</h3>
            <p>Как добавить страницы:</p>
	    	<img src="Pictures/image001.png" height="200px" >
		<img src="Pictures/image002.gif" height="200px" >
		<img src="Pictures/image003.png" height="200px" >
		<img src="Pictures/image004.gif" height="200px" >
		<img src="Pictures/image005.png" height="200px" >
		<img src="Pictures/image006.gif" height="200px" >
		<img src="Pictures/image007.png" height="200px" >
        </section>	    
        <section id="ticket2">
            <h2>Билет 2</h2>
            <h3>Использование агрегации для очистки данных и проверки качества данных. Поиск пропущенных значений с помощью GROUP BY. Приведите примеры.</h3>
            <p>Использование агрегации для очистки данных и проверки качества данных может быть полезным при работе с большими объемами информации. Одним из способов проверки качества данных является поиск пропущенных значений в столбцах и подсчет их с помощью оператора GROUP BY. Вот несколько примеров:</p>
            <pre><code>
Вывод всех клиентов с незаполненным номером телефона
		    
select * from customers
where phone is null;
            </code></pre>
            <pre><code>
Поиск количества пропущенных значений в столбце "age" таблицы "users":
		    
SELECT COUNT(*) AS missing_age_count
FROM users
WHERE age IS NULL;
            </code></pre>
            <p>Агрегация данных и использование GROUP BY позволяют эффективно очищать и проверять качество данных, включая поиск пропущенных значений. Вот несколько примеров использования агрегации и GROUP BY для этих целей:</p>
            <pre><code>
Подсчет пропущенных значений в столбце

sql
SELECT COUNT(*) AS Missing_Values_Count
FROM Customers
WHERE Age IS NULL;
            </code></pre>
            <pre><code>
Расчет среднего значения с исключением пропущенных значений

SELECT AVG(Цена) AS AveragePrice
FROM Products
WHERE Цена IS NOT NULL;

            </code></pre>
            <pre><code>
Предположим, у нас есть таблица "Заказы" с колонками "Номер заказа", "Дата" и "Сумма". Мы хотим найти сумму заказов для каждой даты и выяснить, есть ли пропущенные даты.
		    
SELECT Дата, SUM(Сумма) AS TotalAmount
FROM Orders
GROUP BY Дата
ORDER BY Дата;

Этот запрос использует GROUP BY для группировки данных по столбцу "Дата" и функцию SUM() для расчета суммы столбца "Сумма" внутри каждой группы. 
Результаты будут отсортированы по дате. Если в исходных данных пропущена определенная дата, она не будет присутствовать в результирующем наборе.
            </code></pre>
 	    <h3>Создайте в CMS Joomla пользовательское меню из трех пунктов, к каждому из которых привязана отдельная страница. Разместите на страницах изображения, таблицы, нумерованные списки и ссылки.</h3>
	    <p>Заходим на сайт http://localhost/joomla/administrator/index.php</p>
		
        </section>
        <section id="ticket3">
            <h2>Билет 3</h2>
    	    <h3>Оконные функции для анализа данных. Ключевые слова в оконных функциях. Статистика с оконными функциями. Приведите примеры.</h3>
            <p>Оконная функция- это функция, которая работает с выделенным набором строк и выполняет вычисления для этого набора строк в отдельном столбце.
Оконные функции являются мощным инструментом для анализа данных в рамках определенного окна или группы записей. Они позволяют выполнять вычисления и агрегирование данных на основе предопределенного порядка или группировки. 
Виды оконных функций:
		    
1.Агрегирующие (over)
2.Ранжирующие (rows/range)
3.Функции смещения (lag/lead, предыдущая/последующая)
		    
Ниже приведены некоторые ключевые слова и примеры оконных функций, а также использование оконных функций для статистического анализа данных:</p>
 	    <p>1. OVER: Это ключевое слово указывает на определение окна для выполнения функции. Оно может принимать различные параметры, такие как PARTITION BY (группировка данных), ORDER BY (порядок данных) и другие. </p>
            <pre><code>
Рейтинг клиентов по сумме покупок

select customer_id, sum(sales_amount), rank() over(order by sum(sales_amount) desc)
from sales
group by 1;
            </code></pre>
            <pre><code>
Накопительный итог до 2016 года для каждого дилерского центра

select dealership_id, sales_transaction_date, sales_amount,
sum(sales_amount) over(partition by dealership_id order by sales_transaction_date rows BETWEEN unbounded preceding AND current row) as Накопительный_итог
from sales
where dealership_id is not null and sales_transaction_date < '01.01.2016';
            </code></pre>
            <pre><code>
Вывод значения следующего размера заказа

select sales_transaction_date, sales_amount, lead(sales_amount) over (order by sales_transaction_date) AS размер_следующего_заказа
from sales;
            </code></pre>
            <p>2. ROWS/RANGE: Эти ключевые слова определяют размер окна или диапазон данных, которые будут использоваться для выполнения функции.</p>		
            <pre><code>
Расчет среднего значения продаж за последние 7 дней
SELECT Дата, Сумма,
AVG(Сумма) OVER (ORDER BY Дата ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS AverageSales 
FROM Продажи;
            </code></pre>
            <p>3. LAG/LEAD: Эти функции позволяют получить значения предыдущей или следующей записи внутри окна.</p>
            <pre><code>
Расчет разницы в продажах между текущим и предыдущим днем
		    
SELECT Дата, Сумма,
   	Сумма - LAG(Сумма) OVER (ORDER BY Дата) AS SalesDifference
FROM Продажи;
            </code></pre>
	    <p>Оконные функции могут быть использованы для выполнения различных статистических вычислений, таких как среднее значение, медиана, стандартное отклонение и другие. Эти функции позволяют анализировать данные внутри определенного окна, что дает более гибкие и детальные результаты анализа данных.</p>
            <h3>.Создайте в CMS Joomla три роли: зарегистрированный пользователь, менеджер и директор. При входе у каждого из них должно появляться меню, состоящее из двух пунктов. Первый пункт открывает страницу, общую для всех пользователей, а второй - только для соответствующей роли.</h3>
	</section>
	</section>


	<section id="ticket4">
            <h2>Билет 4</h2>
            <h3>Использование Python в базе данных SQLAlchemy (алхимия). Использование Python с ноутбуками Jupyter. Чтение и запись в базу данных с помощью Pandas. Выполнение визуализации данных с помощью Pandas.</h3>
            <p>Python является мощным языком программирования для работы с базами данных и анализа данных. Вот некоторые ключевые инструменты и подходы, которые можно использовать: 

1. SQLAlchemy: SQLAlchemy - это популярный инструмент (ORM (технология программирования, которая связывает базы данных с концепциями объектно-ориентированных языков программирования, создавая «виртуальную объектную базу данных») библиотека) в Python для работы с базами данных. Он обеспечивает абстракцию над различными системами управления базами данных (СУБД) и позволяет создавать, читать, обновлять и удалять данные. SQLAlchemy предоставляет ORM (объектно-реляционное отображение) для более удобного взаимодействия с базой данных. 
Пример использования SQLAlchemy для подключения к базе данных SQLite и выполнения запроса: </p>
            <pre><code>
from sqlalchemy import create_engine
 
# Подключение к базе данных SQLite
engine = create_engine('sqlite:///database.db')
 
# Выполнение запроса
result = engine.execute("SELECT * FROM my_table")
for row in result:
	print(row)

            </code></pre>
            <p>2.Использование Python с ноутбуками Jupyter: Ноутбуки Jupyter предоставляют интерактивную среду для выполнения Python-кода, анализа данных и визуализации. Вы можете использовать библиотеки, такие как Pandas и Matplotlib, для чтения, обработки и визуализации данных в ноутбуках Jupyter.
 
		    3. Чтение и запись в базу данных с помощью Pandas: Pandas - это мощная библиотека для анализа данных в Python. Она также предоставляет удобные методы для чтения и записи данных в базу данных через SQLAlchemy.
		    Пример чтения данных из базы данных в Pandas DataFrame (многомерный массив(таблица), в котором столбы являются объекты класса Series):
 </p>
            <pre><code>
 Пример чтения данных из базы данных в Pandas DataFrame (многомерный массив(таблица), в котором столбы являются объекты класса Series):

import pandas as pd
from sqlalchemy import create_engine
 
# Подключение к базе данных SQLite
engine = create_engine('sqlite:///database.db')
 
# Чтение данных в DataFrame
df = pd.read_sql_query('SELECT * FROM my_table', engine)
            </code></pre>
            <pre><code>
  Пример записи данных из DataFrame в базу данных:
		    
# Запись данных из DataFrame в базу данных
df.to_sql('new_table', engine, if_exists='replace')
            </code></pre>
            <p>4. Визуализация данных с помощью Pandas: Pandas предоставляет встроенные методы для визуализации данных. Вы можете использовать методы, такие как `plot()`, `plot.bar()`, `plot.hist()`, чтобы создавать графики и диаграммы из ваших данных.
1.plot()- линейная
2.plot.bar() - столбчатая
3.plot.hits() - гистограмма
 Пример выполнения визуализации данных с помощью Pandas: </p>
            <pre><code>
 Пример выполнения визуализации данных с помощью Pandas:
		    
import pandas as pd
 
# Создание DataFrame
data = {'Страна': ['Россия', 'США', 'Китай', 'Германия'],
    	'Население': [144, 328, 1404, 83]}
df = pd.DataFrame(data)
 
# Визуализация данных
df.plot.bar(x='Страна', y='Население', title='Население по странам')

            </code></pre>
	</section>

        <section id="ticket5">
            <h2>Билет 5</h2>
    	    <h3>Вопрос 5:</h3>
            <p>Текст вопроса и ответа на него...</p>
            <pre><code>
SQL или другой код, если необходимо
            </code></pre>
    	    <h3>Рассчитать самую низкую цену, самую высокую цену, среднюю цену и стандартное отклонение цены для всех продуктов, которые когда-либо продавала компания.
                Проанализировать и рассчитать стоимость продуктов, используя агрегатные функции с условием GROUP BY. </h3>
                <p>Менеджер по маркетингу хочет знать минимальное, максимальное, среднее и стандартное отклонение цены для каждого типа продукта. Вычислить и отобразить данные, используя условие HAVING</p>
                <pre><code>
                 select dealership_id, product_id, min(sales_amount), max(sales_amount), round(avg(sales_amount)) as средняя_цена, STDDEV(sales_amount) as cтандартное_отклонение
                from sales
                where dealership_id is not null
                group by 1, 2
                having min(sales_amount)<> max(sales_amount)
                order by 1, 2; 
                </code></pre>
	</section>

        <section id="ticket6">
            <h2>Билет 6</h2>
    	    <h3>Вопрос 3:</h3>
            <p>Текст вопроса и ответа на него...</p>
            <pre><code>
SQL или другой код, если необходимо
            </code></pre>
            <h3>Компания хочет повысить в должности продавцов в своих региональных дилерских центрах. Для этого необходимо узнать стаж работы сотрудников на занимаемой должности. Написать запрос, который ранжирует продавцов в соответствии с датой их приема на работу для каждого дилерского центра.</h3>
            <pre><code>
                select dealership_id, salesperson_id, hire_date, dense_rank() over(partition by dealership_id order by hire_date) as рейтинг
                from salespeople;  
            </code></pre>
	</section>

        <section id="ticket7">
            <h2>Билет 7</h2>
    	    <h3>Вопрос 3:</h3>
            <p>Текст вопроса и ответа на него...</p>
            <pre><code>
SQL или другой код, если необходимо
            </code></pre>
            <h3>Чтобы повысить эффективность продаж, отдел продаж решил покупать обед для всех продавцов в компании каждый раз, когда они превышают цифру лучшего ежедневного общего дохода, достигнутого за последние 30 дней. Напишите запрос, который выводит общий объем продаж в долларах за определенный день и цель, которую продавцы должны превзойти на этот день, начиная с 1 января 2019 года.</h3>
            <pre><code>
                with daily_sales as (
                    select date(sales_transaction_date) as sales_date, sum(sales_amount) as daily_sales
                    from sales
                    group by date(sales_transaction_date)
                )
                select sales_date, daily_sales, max(daily_sales) over (
                        order by sales_date
                        rows between 30 preceding and current row
                    ) as target
                from daily_sales
                where sales_date >= '2019-01-01';
            </code></pre>
	</section>

        <section id="ticket8">
            <h2>Билет 8</h2>
    	    <h3>Вопрос 3:</h3>
            <p>Текст вопроса и ответа на него...</p>
            <pre><code>
SQL или другой код, если необходимо
            </code></pre>
    	    <h3>Отдел продаж хочет видеть, как работает компания по направлению продажи в целом, а также как работают отдельные дилерские центры внутри компании. Чтобы достичь этого, руководитель отдела продаж хотел бы, чтобы вы провели для него анализ:
                ✔	Рассчитайте общую сумму продаж по дням за все дни 2018 года (то есть до даты 1 января 2019 года);
                ✔	Рассчитайте скользящее среднее значение за 30 дней для ежедневного 
                количества сделок купли-продажи.</h3>
            <pre><code>
                with daily_sales as (
                    select dealership_id, date(sales_transaction_date) as sales_date, sum(sales_amount) as daily_sales
                    from sales
                    group by 1, date(sales_transaction_date)
                ),
                sum_dealership as (
                    select dealership_id, sum(sales_amount) as sum_2018
                    from sales
                    group by 1)
                select dealership_id, sales_date, daily_sales, avg(daily_sales) over(
                    order by sales_date
                    rows between 30 preceding and current row)
                    as скользящее_среднее,
                    sum_2018 as сумма_за_2018
                from daily_sales
                join sum_dealership using(dealership_id)
                where sales_date >= '01.01.2018' and sales_date < '01.01.2019' and dealership_id is not null
                group by 1, 2, 3, 5
                order by 1, 2;
            </code></pre>
            <pre><code>
            Второй вариант:
            
                SELECT DATE(sales_transaction_date) AS day, SUM(sales_amount) AS total_sales FROM sales
                WHERE sales_transaction_date >= '2018-01-01' AND sales_transaction_date < '2019-01-01'
                GROUP BY DATE(sales_transaction_date)
                ORDER BY DATE(sales_transaction_date);
            </code></pre>
	</section>

        <section id="ticket9">
            <h2>Билет 10</h2>
    	    <h3>Вопрос 3:</h3>
            <p>Текст вопроса и ответа на него...</p>
            <pre><code>
SQL или другой код, если необходимо
            </code></pre>
	</section>

        <section id="ticket11">
            <h2>Билет 11</h2>
    	    <h3>Вопрос 3:</h3>
            <p>Текст вопроса и ответа на него...</p>
            <pre><code>
SQL или другой код, если необходимо
            </code></pre>
	</section>

        <section id="ticket12">
            <h2>Билет 12</h2>
    	    <h3>Вопрос 3:</h3>
            <p>Текст вопроса и ответа на него...</p>
            <pre><code>
SQL или другой код, если необходимо
            </code></pre>
	</section>

        <section id="ticket13">
            <h2>Билет 13</h2>
    	    <h3>Вопрос 3:</h3>
            <p>Текст вопроса и ответа на него...</p>
            <pre><code>
SQL или другой код, если необходимо
            </code></pre>
	</section>

        <section id="ticket14">
            <h2>Билет 14</h2>
    	    <h3>Вопрос 3:</h3>
            <p>Текст вопроса и ответа на него...</p>
            <pre><code>
SQL или другой код, если необходимо
            </code></pre>
	</section>

        <section id="ticket15">
            <h2>Билет 15</h2>
    	    <h3>Вопрос 3:</h3>
            <p>Текст вопроса и ответа на него...</p>
            <pre><code>
SQL или другой код, если необходимо
            </code></pre>
	</section>

        <section id="ticket16">
            <h2>Билет 16</h2>
    	    <h3>Вопрос 3:</h3>
            <p>Текст вопроса и ответа на него...</p>
            <pre><code>
SQL или другой код, если необходимо
            </code></pre>
	</section>

        <section id="ticket17">
            <h2>Билет 17</h2>
    	    <h3>Вопрос 3:</h3>
            <p>Текст вопроса и ответа на него...</p>
            <pre><code>
SQL или другой код, если необходимо
            </code></pre>
	</section>

        <section id="ticket18">
            <h2>Билет 18</h2>
    	    <h3>Вопрос 3:</h3>
            <p>Текст вопроса и ответа на него...</p>
            <pre><code>
SQL или другой код, если необходимо
            </code></pre>
	</section>
	    
    </main>
</body>
</html>
